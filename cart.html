<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carrinho - Delícia Express</title>
    <link rel="stylesheet" href="./css/tailwind.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="./css/style.css">
    <link rel="shortcut icon" href="./images/favicon.png" type="image/x-icon">
</head>
<body class="bg-gray-50 font-sans antialiased">
    <!-- Cabeçalho/Navegação -->
    <header class="bg-white shadow-md sticky top-0 z-50">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center cursor-pointer nav-link-logo">
                <i class="fas fa-utensils text-2xl text-orange-500 mr-2"></i>
                <h1 class="text-2xl font-bold text-gray-800">Delícia <span class="text-orange-500">Express</span></h1>
            </div>

            <nav class="hidden md:flex space-x-8">
                <a href="index.html" class="nav-link">Início</a>
                <a href="menu.html" class="nav-link">Cardápio</a>
                <a href="about.html" class="nav-link">Sobre Nós</a>
                <a href="contact.html" class="nav-link">Contato</a>
                <a href="delivery.html" class="nav-link">Delivery</a>
                <a href="blog.html" class="nav-link">Blog</a>
                <a href="faq.html" class="nav-link">FAQ</a>
            </nav>

            <div class="flex items-center space-x-4">
                <div class="auth-links">
                    <!-- Conteúdo será preenchido pelo auth.js -->
                </div>
                <div class="relative">
                    <a href="cart.html" class="nav-link cart-icon p-2 rounded-full hover:bg-gray-100 active">
                        <i class="fas fa-shopping-cart text-xl text-gray-700"></i>
                        <span class="cart-badge hidden">0</span>
                    </a>
                </div>
                <button class="md:hidden text-gray-700 p-2 rounded hover:bg-gray-100" id="mobile-menu-button" aria-label="Abrir menu">
                    <i class="fas fa-bars text-2xl"></i>
                </button>
            </div>
        </div>

        <!-- Menu Mobile -->
        <div class="md:hidden hidden bg-white py-2 px-4 shadow-lg border-t border-gray-200" id="mobile-menu">
            <a href="index.html" class="block py-2 nav-link">Início</a>
            <a href="menu.html" class="block py-2 nav-link">Cardápio</a>
            <a href="about.html" class="block py-2 nav-link">Sobre Nós</a>
            <a href="contact.html" class="block py-2 nav-link">Contato</a>
            <a href="delivery.html" class="block py-2 nav-link">Delivery</a>
            <a href="blog.html" class="block py-2 nav-link">Blog</a>
            <a href="faq.html" class="block py-2 nav-link">FAQ</a>
            <a href="cart.html" class="block py-2 nav-link cart-icon-mobile active">Carrinho</a>
            <div class="block py-2 auth-links">
                <!-- Conteúdo será preenchido pelo auth.js -->
            </div>
        </div>
    </header>

    <!-- Conteúdo Principal -->
    <main class="container mx-auto px-4 py-8 min-h-screen">
        <h1 class="text-3xl font-bold text-gray-800 mb-8 text-center">Seu Carrinho de Compras</h1>

        <div class="flex flex-col lg:flex-row gap-8">
            <!-- Itens do Carrinho -->
            <div class="lg:w-2/3">
                <div class="bg-white rounded-lg shadow-md p-4 sm:p-6" id="cart-items-container">
                    <div class="text-center py-8" id="empty-cart-message">
                        <i class="fas fa-shopping-cart text-gray-300 text-5xl mb-4"></i>
                        <h2 class="text-2xl font-semibold text-gray-500 mb-2">Seu carrinho está vazio</h2>
                        <p class="text-gray-500 mb-6">Adicione itens do nosso delicioso cardápio</p>
                        <a href="menu.html" class="bg-orange-500 hover:bg-orange-600 text-white py-2 px-6 rounded-lg transition duration-300 inline-block">
                            Ver Cardápio
                        </a>
                    </div>
                    <!-- Lista de itens será carregada dinamicamente -->
                </div>
            </div>

            <!-- Resumo do Pedido -->
            <div class="lg:w-1/3">
                <div class="bg-white rounded-lg shadow-md p-6 sticky top-24">
                    <h2 class="text-xl font-bold text-gray-800 mb-6 border-b pb-3">Resumo do Pedido</h2>

                    <div class="mb-6 space-y-2">
                        <div class="flex justify-between">
                            <span class="text-gray-600">Subtotal</span>
                            <span id="subtotal">R$ 0,00</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">Taxa de entrega</span>
                            <span id="delivery-fee">R$ 5,99</span>
                        </div>
                        <div class="flex justify-between font-bold text-gray-800 border-t pt-2 mt-2">
                            <span>Total</span>
                            <span id="cart-total">R$ 5,99</span>
                        </div>
                    </div>

                    <button id="checkout-button" class="w-full bg-orange-500 hover:bg-orange-600 text-white py-3 px-4 rounded transition duration-300 flex items-center justify-center">
                        <i class="fas fa-check-circle mr-2"></i>
                        Finalizar Pedido
                    </button>

                    <div class="mt-6 text-center">
                        <p class="text-sm text-gray-500">
                            <i class="fas fa-lock text-gray-400 mr-1"></i>
                            Pagamento 100% seguro
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Rodapé -->
    <footer class="bg-gray-800 text-white pt-12 pb-8 mt-16">
        <div class="container mx-auto px-4">
            <div class="flex flex-col md:flex-row justify-between gap-8">
                <div class="mb-6 md:mb-0 md:w-1/3">
                    <div class="flex items-center mb-4">
                        <i class="fas fa-utensils text-2xl text-orange-500 mr-2"></i>
                        <h2 class="text-2xl font-bold">Delícia <span class="text-orange-500">Express</span></h2>
                    </div>
                    <p class="text-gray-400 mb-4">Sabor e qualidade entregues na sua porta com rapidez e excelência.</p>
                    <div class="flex space-x-4">
                        <a href="#" class="text-gray-400 hover:text-white transition duration-300">
                            <i class="fab fa-facebook-f"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-white transition duration-300">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-white transition duration-300">
                            <i class="fab fa-twitter"></i>
                        </a>
                    </div>
                </div>
                <div class="grid grid-cols-2 sm:grid-cols-3 gap-8 md:w-2/3">
                    <div>
                        <h3 class="text-lg font-semibold mb-4 uppercase tracking-wider text-gray-300">Links Rápidos</h3>
                        <ul class="space-y-2">
                            <li><a href="index.html" class="text-gray-400 hover:text-white transition duration-300 text-sm">Início</a></li>
                            <li><a href="menu.html" class="text-gray-400 hover:text-white transition duration-300 text-sm">Cardápio</a></li>
                            <li><a href="about.html" class="text-gray-400 hover:text-white transition duration-300 text-sm">Sobre Nós</a></li>
                            <li><a href="contact.html" class="text-gray-400 hover:text-white transition duration-300 text-sm">Contato</a></li>
                        </ul>
                    </div>
                    <div>
                        <h3 class="text-lg font-semibold mb-4 uppercase tracking-wider text-gray-300">Suporte</h3>
                        <ul class="space-y-2">
                            <li><a href="faq.html" class="text-gray-400 hover:text-white transition duration-300 text-sm">FAQ</a></li>
                            <li><a href="delivery.html" class="text-gray-400 hover:text-white transition duration-300 text-sm">Política de Entrega</a></li>
                            <li><a href="#" class="text-gray-400 hover:text-white transition duration-300 text-sm">Termos de Uso</a></li>
                            <li><a href="#" class="text-gray-400 hover:text-white transition duration-300 text-sm">Política de Privacidade</a></li>
                        </ul>
                    </div>
                    <div>
                        <h3 class="text-lg font-semibold mb-4 uppercase tracking-wider text-gray-300">Contato</h3>
                        <ul class="space-y-2">
                            <li class="flex items-start">
                                <i class="fas fa-map-marker-alt text-orange-500 mt-1 mr-2"></i>
                                <span class="text-gray-400 text-sm">Av. Exemplo, 123<br>São Paulo, SP</span>
                            </li>
                            <li class="flex items-center">
                                <i class="fas fa-phone text-orange-500 mr-2"></i>
                                <span class="text-gray-400 text-sm">(11) 5555-5555</span>
                            </li>
                            <li class="flex items-center">
                                <i class="fas fa-envelope text-orange-500 mr-2"></i>
                                <span class="text-gray-400 text-sm">contato@deliciaexpress.com</span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="border-t border-gray-700 mt-10 pt-6 text-center text-gray-500 text-sm">
                <p> 2024 Delícia Express. Todos os direitos reservados. Desenvolvido com <i class="fas fa-heart text-red-500"></i>.</p>
            </div>
        </div>
    </footer>

    <!-- JavaScript -->
    <script src="js/script.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/navigation-fix.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Verificar se o usuário está logado antes de finalizar a compra
            const checkoutButton = document.getElementById('checkout-button');
            if (checkoutButton) {
                const originalCheckoutHandler = checkoutButton.onclick;
                
                checkoutButton.addEventListener('click', function(event) {
                    const currentUser = getCurrentUser();
                    
                    // Se o carrinho estiver vazio, mostrar aviso
                    if (Object.keys(window.cart || {}).length === 0) {
                        showNotification('Seu carrinho está vazio. Adicione alguns itens antes de finalizar o pedido.', 'warning');
                        return;
                    }
                    
                    // Se o usuário não estiver logado, redirecionar para login
                    if (!currentUser || !currentUser.isLoggedIn) {
                        event.preventDefault();
                        showNotification('Faça login para finalizar seu pedido', 'info');
                        
                        // Salvar estado do carrinho e redirecionar para login após 1 segundo
                        setTimeout(() => {
                            window.location.href = 'login.html';
                        }, 1000);
                        return;
                    }
                    
                    // Se o usuário estiver logado e o carrinho não estiver vazio, continuar com o checkout normal
                    handleCheckout.call(this);
                });
            }
        });
    </script>
</body>
</html>
